"use strict";

const {
  join
} = require('path');

const unzip = require('./unzip');

const {
  emptyDirSync
} = require('fs-extra');

const runWithServerless = require('./runWithServerless');
/**
 * Use this function to run a deployment bundle (zip file) downloaded from app.layer0.co.
 * @param filePath The path to the deployment bundle
 */


module.exports = async function runDeploymentArchive(filePath) {
  const dest = join(process.cwd(), filePath).replace('.zip', '');
  const layer0Dir = join(dest, '.layer0');
  emptyDirSync(dest);
  await unzip(filePath, layer0Dir);
  await runWithServerless(layer0Dir);
};